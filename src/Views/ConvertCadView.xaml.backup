<base:LecgWindow x:Class="LECG.Views.ConvertCadView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:base="clr-namespace:LECG.Views.Base"
    xmlns:comp="clr-namespace:LECG.Views.Components"
    xmlns:icons="clr-namespace:LECG.Utils" Title="Convert CAD to Detail Item" Width="450" WindowStartupLocation="CenterScreen" SizeToContent="Height" WindowIcon="{x:Static icons:Icons.Layers}">

    <base:LecgWindow.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/LECG;component/src/Resources/Styles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </base:LecgWindow.Resources>

    <Grid Margin="{StaticResource ViewContentMargin}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="{DynamicResource HeaderMarginSmall}">
            <TextBlock Text="Convert CAD Block" FontWeight="{StaticResource WeightBold}" FontSize="{StaticResource FontSizeTitle}" Foreground="{StaticResource TextPrimaryBrush}" Margin="{StaticResource TitleMarginSmall}"/>
            <TextBlock Text="Clean, center, and convert CAD to Detail Item." FontSize="{StaticResource FontSizeSmall}" Foreground="{StaticResource TextSecondaryBrush}"/>
        </StackPanel>

        <!-- Source Selection -->
        <Border Grid.Row="1" Style="{DynamicResource CardStyle}" Padding="16" Margin="0,0,0,16">
            <StackPanel>
                <TextBlock Text="SOURCE" Style="{DynamicResource LabelStyle}" Margin="0,0,0,8" Opacity="0.5"/>

                <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                    <RadioButton Content="Import Instance" IsChecked="{Binding UseSelectedImport}" Margin="0,0,16,0" GroupName="Source"/>
                    <RadioButton Content="DWG File" IsChecked="{Binding IsFileMode}" GroupName="Source"/>
                </StackPanel>

                <!-- Selection Control -->
                <StackPanel Visibility="{Binding SelectionVisibility}">
                    <TextBlock Text="Select CAD in Project:" Style="{DynamicResource LabelStyle}" Margin="0,0,0,4"/>
                    <comp:SelectionControl DataContext="{Binding Selection}" IsEnabled="True"/>
                </StackPanel>

                <!-- File Selection -->
                <StackPanel Visibility="{Binding FileVisibility}">
                    <TextBlock Text="Select DWG File:" Style="{DynamicResource LabelStyle}" Margin="0,0,0,4"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="32"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Text="{Binding DwgFilePath}" Style="{DynamicResource InputStyle}" IsReadOnly="False"/>
                        <Button Content="..." Grid.Column="1" Command="{Binding BrowseDwgCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="4,0,0,0"/>
                    </Grid>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Settings -->
        <Border Grid.Row="2" Style="{DynamicResource CardStyle}" Padding="16" Margin="0,0,0,16">
            <StackPanel>
                <TextBlock Text="FAMILY SETTINGS" Style="{DynamicResource LabelStyle}" Margin="0,0,0,12" Opacity="0.5"/>

                <TextBlock Text="New Family Name" Style="{DynamicResource LabelStyle}" Margin="0,0,0,4"/>
                <TextBox Text="{Binding NewFamilyName}" Style="{DynamicResource InputStyle}" Margin="0,0,0,12"/>

                <TextBlock Text="Template Path" Style="{DynamicResource LabelStyle}" Margin="0,0,0,4"/>
                <Grid Margin="0,0,0,12">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="32"/>
                    </Grid.ColumnDefinitions>
                    <TextBox Text="{Binding TemplatePath}" Style="{DynamicResource InputStyle}" IsReadOnly="False"/>
                    <Button Content="..." Grid.Column="1" Command="{Binding BrowseTemplateCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="4,0,0,0"/>
                </Grid>
            </StackPanel>
        </Border>

        <!-- Line Styles -->
        <Border Grid.Row="3" Style="{DynamicResource CardStyle}" Padding="16" Margin="0,0,0,16">
            <StackPanel>
                <TextBlock Text="LINE STYLE" Style="{DynamicResource LabelStyle}" Margin="0,0,0,12" Opacity="0.5"/>

                <TextBlock Text="Style Name" Style="{DynamicResource LabelStyle}" Margin="0,0,0,4"/>
                <TextBox Text="{Binding LineStyleName}" Style="{DynamicResource InputStyle}" Margin="0,0,0,12"/>

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="100"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Margin="0,0,12,0">
                        <TextBlock Text="Color" Style="{DynamicResource LabelStyle}" Margin="0,0,0,4"/>
                        <ComboBox ItemsSource="{Binding AvailableColors}" SelectedItem="{Binding SelectedColorItem}" Height="30">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <Rectangle Width="16" Height="16" Fill="{Binding Brush}" Margin="0,0,8,0"/>
                                        <TextBlock Text="{Binding Name}" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </StackPanel>

                    <StackPanel Grid.Column="1">
                        <TextBlock Text="Weight (1-16)" Style="{DynamicResource LabelStyle}" Margin="0,0,0,4"/>
                        <TextBox Text="{Binding LineWeight}" Style="{DynamicResource InputStyle}" Height="30"/>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Border>

        <!-- Actions -->
        <Grid Grid.Row="4" Margin="{StaticResource ButtonRowMarginSmall}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="12"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Button Content="Cancel" Grid.Column="0" Height="{StaticResource ButtonHeightMedium}" Command="{Binding ExecuteCancelCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
            <Button Content="Convert" Grid.Column="2" Height="{StaticResource ButtonHeightMedium}" Command="{Binding RunCommand}" IsEnabled="{Binding CanRun}" Style="{DynamicResource PrimaryButtonStyle}"/>
        </Grid>
    </Grid>
</base:LecgWindow>
